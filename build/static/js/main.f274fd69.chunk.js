(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{24:function(e,t,n){e.exports=n(41)},29:function(e,t,n){},41:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(16),c=n.n(o),u=(n(29),n(10)),s=n(11),i=n(12),l=n(13),m=n(6),d=n.n(m),p=n(8),v=n(7),f=n.n(v),b=(n(31),n(42),n(33),{apiKey:"",authDomain:"",databaseURL:"",projectId:"",storageBucket:"",messagingSenderId:"",appId:""});f.a.initializeApp(b);var h=new f.a.auth.GoogleAuthProvider,E=function(){return w.signInWithPopup(h)},j=f.a.firestore(),w=f.a.auth();window.auth=w;f.a.storage();var y=function(){var e=Object(p.a)(d.a.mark((function e(t){var n,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.email){e.next=3;break}return e.abrupt("return",null);case 3:return e.next=5,j.doc("users/".concat(n));case 5:if(r=e.sent,console.log(r),!r.id){e.next=9;break}return e.abrupt("return",r);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function O(e,t){j.collection("reservations").doc().set({startTime:e,endTime:t,user:w.currentUser.email})}window.firestore=j;var g=n(43),k=Object(r.createContext)(),x=function(e){Object(l.a)(n,e);var t=Object(i.a)(n);function n(){var e;Object(u.a)(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).state={reservations:[]},e.unsubscribeFromFirestore=null,e.componentDidMount=function(){e.unsubscribeFromFirestore=j.collection("reservations").orderBy("startTime","desc").onSnapshot((function(t){var n=t.docs.map(C);e.setState({reservations:n})}))},e.componentWillUnmount=function(){e.unsubscribeFromFirestore()},e}return Object(s.a)(n,[{key:"render",value:function(){var e=(this.state||{}).reservations,t=function(e){return console.log(e),e.some((function(e){var t=new Date;return Object(g.a)(["data","startTime"],e).toDate()<t&&Object(g.a)(["data","endTime"],e).toDate()>t}))}(e),n=this.props.children;return a.a.createElement(k.Provider,{value:{reservations:e,isReserved:t}},n)}}]),n}(r.Component);function C(e){return{id:e.id,data:e.data()}}var D=n(44);var F=Object(D.a)((function(e,t){return a.a.createElement("section",{style:e,className:t?"hero is-danger":"hero is-primary"},a.a.createElement("div",{className:"hero-body"},a.a.createElement("div",{className:"container"},a.a.createElement("h1",{className:"title"},t?"Busy":"Free"))))}))({marginBottom:"20px"});function A(){var e=Object(r.useContext)(k).isReserved;return F(e)}var S=n(21),B=n(20);function T(){return new Date}function I(){var e=T();return e.setHours(e.getHours()+1),e}function N(){var e=Object(r.useContext)(k).isReserved;return a.a.createElement(B.Button,{disabled:e,color:"primary",onClick:function(){e||O.apply(void 0,Object(S.a)([T(),I()]))}}," Reserve now ")}var W=n(17),R=n.n(W),U=function(e){var t=e.data,n=t.startTime,r=t.endTime,o=t.user;return a.a.createElement("tr",null,a.a.createElement("td",null,R()(n.toDate()).calendar()),a.a.createElement("td",null,R()(r.toDate()).calendar()),a.a.createElement("td",null,o))},P=function(){var e=Object(r.useContext)(k).reservations;return a.a.createElement("table",{className:"table"},a.a.createElement("thead",null,a.a.createElement("tr",null,a.a.createElement("td",null,"Start Date:"),a.a.createElement("td",null,"End Date:"),a.a.createElement("td",null,"User:"))),a.a.createElement("tbody",null,e.map((function(e){return a.a.createElement(U,Object.assign({},e,{key:e.id}))}))))},M=n(22),G=Object(r.createContext)({user:null}),H=function(e){Object(l.a)(n,e);var t=Object(i.a)(n);function n(){var e;Object(u.a)(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).state={user:null},e.unsubscribeFromAuth=null,e.componentDidMount=Object(p.a)(d.a.mark((function t(){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.unsubscribeFromAuth=w.onAuthStateChanged(function(){var t=Object(p.a)(d.a.mark((function t(n){var r;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=5;break}return t.next=3,y(n);case 3:(r=t.sent)&&r.onSnapshot((function(t){e.setState({user:Object(M.a)({uid:t.id},t.data())})}));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}}),t)}))),e.componentWillUnmount=function(){e.unsubscribeFromAuth()},e}return Object(s.a)(n,[{key:"render",value:function(){var e=this.state.user,t=this.props.children;return a.a.createElement(G.Provider,{value:e},t)}}]),n}(r.Component);var J=function(){return Object(r.useContext)(G)?a.a.createElement(x,null,a.a.createElement(A,null),a.a.createElement(N,null),a.a.createElement(P,null)):a.a.createElement("button",{onClick:E},"Sign In With Google")};var z=function(){return a.a.createElement("div",{className:"App"},a.a.createElement("link",{rel:"stylesheet",type:"text/css",href:"src/bulma.min.css"}),a.a.createElement(H,null,a.a.createElement(J,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(z,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[24,1,2]]]);
//# sourceMappingURL=main.f274fd69.chunk.js.map